import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# Configure portal password policy

This example demonstrates how to view and update the portal password policy in ONLYOFFICE DocSpace using the API.
Administrators can use it to control password length and complexity rules (uppercase letters, digits, special symbols) and to inspect the effective regex patterns generated by the server.

## Before you start

1. Replace `https://yourportal.onlyoffice.com` and `YOUR_API_KEY` with your actual DocSpace portal URL and API key. Ensure you have the necessary data and permissions to manage web plugins.
2. Before you can make requests to the API, you need to authenticate. Check out the [Personal access tokens](/docspace/api-backend/get-started/authentication/personal-access-tokens.md) page to learn how to obtain and use access tokens.

<details>
  <summary>Full example</summary>
<Tabs>
  <TabItem value="nodejs" label="Node.js">
  
  ``` ts
  // Configure API endpoint and access token
  const BASE_URL = 'https://yourportal.onlyoffice.com';
  const API_KEY = 'YOUR_API_KEY';

  // Common headers with authentication
  const HEADERS = {
    Authorization: `Bearer ${API_KEY}`,
    Accept: 'application/json',
    'Content-Type': 'application/json',
  };

  // Step 1: Get current password settings
  async function getPasswordSettings() {
    const url = `${BASE_URL}/api/2.0/settings/security/password`;

    const response = await fetch(url, {
      method: 'GET',
      headers: HEADERS,
    });

    if (!response.ok) {
      return null;
    }

    const body = await response.json();
    return body.response || body;
  }

  // Step 2: Update password settings
  async function setPasswordSettings(settings: {
    minLength: number;
    upperCase: boolean;
    digits: boolean;
    specSymbols: boolean;
  }) {
    const url = `${BASE_URL}/api/2.0/settings/security/password`;

    const response = await fetch(url, {
      method: 'PUT',
      headers: HEADERS,
      body: JSON.stringify(settings),
    });

    if (!response.ok) {
      return null;
    }

    const body = await response.json();
    return body.response || body;
  }

  // Example usage
  (async () => {
    // Load current password settings
    const current = await getPasswordSettings();
    if (!current) return;

    // Apply stricter policy example
    const payload = {
      minLength: 12,
      upperCase: true,
      digits: true,
      specSymbols: true,
    };

    const updated = await setPasswordSettings(payload);
  })();
  ```

  </TabItem>
  <TabItem value="python" label="Python">

  ``` py
  import requests

  # Configure API endpoint and access token
  BASE_URL = "https://yourportal.onlyoffice.com"
  API_KEY = "YOUR_API_KEY"

  # Common headers with authentication
  HEADERS = {
    "Authorization": f"Bearer {API_KEY}",
    "Accept": "application/json",
    "Content-Type": "application/json",
  }

  # Step 1: Get current password settings
  def get_password_settings():
    url = f"{BASE_URL}/api/2.0/settings/security/password"
    response = requests.get(url, headers=HEADERS)

    if not response.ok:
      return None

    raw = response.json()
    return raw.get("response", raw)

  # Step 2: Update password settings
  def set_password_settings(min_length: int, upper_case: bool, digits: bool, spec_symbols: bool):
    url = f"{BASE_URL}/api/2.0/settings/security/password"

    payload = {
      "minLength": min_length,
      "upperCase": upper_case,
      "digits": digits,
      "specSymbols": spec_symbols,
    }

    response = requests.put(url, headers=HEADERS, json=payload)

    if not response.ok:
      return None

    raw = response.json()
    return raw.get("response", raw)

  if __name__ == "__main__":
    current = get_password_settings()
    if current:
      # Example: enforce stronger password policy
      updated = set_password_settings(
        min_length=12,
        upper_case=True,
        digits=True,
        spec_symbols=True,
      )
  ```

  </TabItem>
</Tabs>
</details>

## Step 1: Get current password settings

A GET request is sent to [/api/2.0/settings/security/password](/docspace/api-backend/usage-api/get-password-settings).

The response contains the current password policy, including:

- `minLength`: minimum password length.
- `upperCase`: whether at least one uppercase letter is required.
- `digits`: whether at least one digit is required.
- `specSymbols`: whether at least one special symbol is required.
- `allowedCharactersRegexStr`: regex describing allowed characters.
- `digitsRegexStr`, `upperCaseRegexStr`, `specSymbolsRegexStr`: regex patterns used for validation.

You can use these values to display the effective password rules in the admin UI.

<Tabs>
  <TabItem value="nodejs" label="Node.js">
  
  ``` ts
  async function getPasswordSettings() {
    const url = `${BASE_URL}/api/2.0/settings/security/password`;

    const response = await fetch(url, {
      method: 'GET',
      headers: HEADERS,
    });

    if (!response.ok) {
      return null;
    }

    const body = await response.json();
    return body.response || body;
  }
  ```

  </TabItem>
  <TabItem value="python" label="Python">

  ``` py
  def get_password_settings():
    url = f"{BASE_URL}/api/2.0/settings/security/password"
    response = requests.get(url, headers=HEADERS)

    if not response.ok:
      return None

    raw = response.json()
    return raw.get("response", raw)
  ```

  </TabItem>
</Tabs>

## Step 2: Update password settings

A PUT request is sent to [/api/2.0/settings/security/password](/docspace/api-backend/usage-api/update-password-settings).

The request body includes:

- `minLength`: new minimum password length.
- `upperCase`: whether passwords must include uppercase letters.
- `digits`: whether passwords must include digits.
- `specSymbols`: whether passwords must include special symbols.

The API returns the updated password settings, including regenerated regex patterns, which will be applied to new password changes and user registrations.

<Tabs>
  <TabItem value="nodejs" label="Node.js">
  
  ``` ts
  async function setPasswordSettings(settings: {
    minLength: number;
    upperCase: boolean;
    digits: boolean;
    specSymbols: boolean;
  }) {
    const url = `${BASE_URL}/api/2.0/settings/security/password`;

    const response = await fetch(url, {
      method: 'PUT',
      headers: HEADERS,
      body: JSON.stringify(settings),
    });

    if (!response.ok) {
      return null;
    }

    const body = await response.json();
    return body.response || body;
  }
  ```

  </TabItem>
  <TabItem value="python" label="Python">

  ``` py
  def set_password_settings(min_length: int, upper_case: bool, digits: bool, spec_symbols: bool):
    url = f"{BASE_URL}/api/2.0/settings/security/password"

    payload = {
      "minLength": min_length,
      "upperCase": upper_case,
      "digits": digits,
      "specSymbols": spec_symbols,
    }

    response = requests.put(url, headers=HEADERS, json=payload)

    if not response.ok:
      return None

    raw = response.json()
    return raw.get("response", raw)
  ```

  </TabItem>
</Tabs>