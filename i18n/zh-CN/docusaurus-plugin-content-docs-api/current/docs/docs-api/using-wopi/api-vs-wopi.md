---
sidebar_position: -1
---

# API 与 WOPI

您可以使用 API 或 WOPI 将 [ONLYOFFICE 文档](https://www.onlyoffice.com/office-suite.aspx)与任何云服务集成。

下表将帮助您找出这些选项之间的区别。

|                                                        | **API**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | **WOPI**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| ------------------------------------------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **基本信息**                                       | 应用程序编程接口：描述允许您与不同的 ONLYOFFICE 组件（包括编辑器）交互的主要方法，从而使您能够以编程方式访问它。<br /><br />[了解更多](../get-started/basic-concepts.md)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Web 应用程序开放平台接口：Microsoft 的基于 REST 的协议，它定义了一组操作，使客户端能够访问和更改服务器存储的文件。<br /><br />[了解更多](./overview.md)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| **与 sync&share 和 DMS 解决方案集成**     | 通过 ONLYOFFICE 或其合作伙伴开发的即用型连接器进行集成。<br /><br />[检查所有集成](https://www.onlyoffice.com/all-connectors.aspx)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | 通过 WOPI 连接器/通用 WOPI 客户端集成。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| **协作（模式）**                              | 在实时和段落锁定共同编辑模式之间切换。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | 只有实时协同编辑，模式之间的切换在界面中是不可用的。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| **定制**                                      | - 指定编辑器界面[语言](../usage-api/config/editor/editor.md#lang)<br /><br />- 指定编辑器界面[主题](../usage-api/config/editor/customization/customization-standard-branding.md#uitheme)<br /><br />- <b>聊天</b> 菜单按钮禁用[聊天](../usage-api/config/editor/customization/customization-standard-branding.md#chat)功能<br /><br />- 在编辑器 <b>关于</b> 部分中显示[客户](../usage-api/config/editor/customization/customization-standard-branding.md#customer)信息<br /><br />- 编辑[定制](../usage-api/config/editor/customization/customization-standard-branding.md)可通过用于控制工具栏外观和隐藏它们的参数、品牌<br /><br />- 传递[模板](../usage-api/config/editor/editor.md#templates)以创建新文件<br /><br />- 传递[最近打开的文件](../usage-api/config/editor/editor.md#recent)列表<br /><br />- 连接[插件](../usage-api/config/editor/plugins.md)                                                                                                                                                                                                                                                                                                                                                                                                                   | - 指定编辑器界面[主题](./wopi-discovery.md#parameters)<br /><br />- 指定编辑器界面[主题](./wopi-discovery.md#parameters)<br /><br />- 通过 <b>聊天</b> 菜单按钮禁用[聊天](./wopi-discovery.md#parameters)功能<br /><br />- 在编辑器**关于**部分中显示[客户](./wopi-rest-api/checkfileinfo.md#breadcrumb-properties)信息                                                                                                                                                                                                                                                                                        |
| **拒绝资源请求**                     | 配置请求 ONLYOFFICE 文档可以接受的 [可信集成商](./overview.md#ip-filter)的 IP（白名单）。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | 配置请求 ONLYOFFICE 文档可以接受的 [可信集成商](./overview.md#ip-filter)的 IP（白名单）。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| **限制访问使用 ONLYOFFICE 服务器** | 编辑访问控制是基于 JWT 签名的。生成[文件打开请求](../additional-api/signature/browser.md)需要密钥。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | 没有限制                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| **限制对数据的访问**                         | ONLYOFFICE 服务器的请求验证是基于 JWT 签名的。该请求使用密钥进行[签名](../additional-api/signature/request/token-in-body.md#outgoing-requests)这样可以确保它不被第三方执行。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | 来自 ONLYOFFICE 服务器的请求验证是基于签名请求的私钥和写在 [WOPI 发现 XML中](./wopi-discovery.md) 的 [proof-key](./proof-keys.md) 元素中的公钥的。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **基本操作**                                      | 支持查看、编辑、协同编辑、移动查看编辑、嵌入式文档查看等基本动作。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | 支持查看、编辑和共同编辑的基本操作。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| **通过方法调用的附加操作**            | - [下载](../usage-api/methods.md#downloadas) 请求<br /><br />- 设置[收藏夹](../usage-api/methods.md#setfavorite)状态<br /><br />- 显示带有 [消息](../usage-api/methods.md#showmessage)的工具提示                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | 没有附加的操作                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| **通过事件处理的附加操作**          | - [编辑器](../usage-api/config/events.md#onrequestclose)<br /><br />- [转到](../usage-api/config/editor/customization/customization-standard-branding.md#goback) 文件夹<br /><br />- 从查看模式[切换](../usage-api/config/events.md#onrequesteditrights)到编辑模式<br /><br />- [重命名](../usage-api/config/events.md#onrequestrename)文件<br /><br />- 打开[共享访问](../usage-api/config/events.md#onrequestsharingsettings) 设置对话框<br /><br />- 打开文档[版本历史](../usage-api/config/events.md#onrequesthistory)<br /><br />- [从存储中](../usage-api/config/events.md#onrequestinsertimage)插入图像<br /><br />- [邮件合并](../usage-api/config/events.md#onrequestmailmergerecipients)<br /><br />- 与存储的文档进行[比较](../usage-api/config/events.md#onrequestcomparefile)<br /><br />- 获取[操作链接](../usage-api/config/events.md#onmakeactionlink)<br /><br />- 请求以其他格式[保存](../usage-api/config/events.md#onrequestsaveas)文件<br /><br />- 获取要 [提及](../usage-api/config/events.md#onrequestusers)的用户列表<br /><br />- [创建](../usage-api/config/events.md#onrequestcreatenew)一个新文件 | - [关闭](./postmessage.md#ui_close)编辑器<br /><br />- [转到](./wopi-rest-api/checkfileinfo.md#breadcrumb-properties) 文件夹<br /><br />- 从查看模式[切换](./postmessage.md#ui_edit)到编辑模式<br /><br />- [重命名](./postmessage.md#file_rename)文件<br /><br />- 打开[共享访问](./postmessage.md#ui_sharing) 设置对话框<br /><br />- 打开文档[版本历史](./postmessage.md#ui_fileversions)<br /><br />- 从存储中 [插入图像](./postmessage.md#ui_insertgraphic)<br /><br />- 请求以不同格式[保存](./wopi-rest-api/putrelativefile.md#save-copy-as)文件 |
| **文件锁**                                          | 获取带有 [文档状态](../usage-api/callback-handler.md#status) 的消息，通知有关打开文件进行编辑、关闭未更改的文件或关闭编辑后准备保存的文件。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | - 由请求锁定的online office [锁定](./wopi-rest-api/lock.md) 文件编辑<br /><br />- 通过将文件的自动到期计时器重置为 30 分钟来 [刷新文件的锁定](./wopi-rest-api/refreshlock.md)<br /><br />- 允许 [文件编辑](./wopi-rest-api/unlock.md)                                                                                                                                                                                                                                                                                                                                                                                                                |
| **文件访问权限**                                 | - 查看<br /><br />- [编辑](../usage-api/config/document/permissions.md#edit)<br /><br />- [审阅](../usage-api/config/document/permissions.md#review) （仅适用于文本文档）<br /><br />- [评论](../usage-api/config/document/permissions.md#comment)<br /><br />- [填写表单](../usage-api/config/document/permissions.md#fillforms)仅适用于表单）<br /><br />- [修改内容控件](../usage-api/config/document/permissions.md#modifycontentcontrol) （仅适用于文本文档）<br /><br />- [修改过滤器](../usage-api/config/document/permissions.md#modifyfilter) （仅适用于电子表格）<br /><br />- [复制](../usage-api/config/document/permissions.md#copy)到剪贴板<br /><br />- [下载](../usage-api/config/document/permissions.md#download)<br /><br />- [打印](../usage-api/config/document/permissions.md#print)<br /><br />- [重命名](./wopi-rest-api/checkfileinfo.md#user-permissions-properties)                                                                                                                                                                                                                                                                                                                                                       | - 查看<br /><br />- [编辑](./wopi-rest-api/checkfileinfo.md#usercanwrite)<br /><br />- [审阅](./wopi-rest-api/checkfileinfo.md#user-permissions-properties)（仅适用于文本文档）<br /><br />- [打印](./wopi-rest-api/checkfileinfo.md#nextcloudcollaboraseafile-properties)<br /><br />- [重命名](./wopi-rest-api/checkfileinfo.md#usercanrename)                                                                                                                                                                                                                                                                                                                                                                    |
