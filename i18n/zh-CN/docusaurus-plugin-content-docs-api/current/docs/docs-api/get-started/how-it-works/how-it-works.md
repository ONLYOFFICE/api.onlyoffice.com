---
sidebar_position: -2
---

# 工作原理

在ONLYOFFICE文档中处理文档文件是一个相当简单的过程，但当你点击文档链接在浏览器中打开它、保存文档或将其从计算机上传到文档服务器时，需要了解一些相关操作的原理。

## 用户与文档的交互

用户与文档的交互在客户端和服务器端都有进行。

下面将解释本说明文档中使用的主要概念。

客户端包括：

- **文档管理器**：显示在用户浏览器中的文档列表，用户可以在其中选择所需的文档并对其执行一些操作（根据所提供的权限，用户可以打开文档进行查看或编辑，也可以与其他用户共享文档）。
- **文档编辑器**：具备所有常见文档编辑功能的文档查看和编辑界面，用作用户与**文档编辑服务**之间的媒介。

服务器端包括：

- **文档存储服务**：一种服务器服务，用于存储所有用户有权访问的文档。它为**文档管理器**提供文档ID和指向这些文档的链接，用户可以在浏览器中看到这些内容。
- **文档编辑服务**：一种服务器服务，允许用户进行文档的查看和编辑（前提是用户拥有相应的权限）。**文档编辑器**界面用于访问**文档编辑服务**的所有功能。
- **文档命令服务**：一种服务器服务，允许通过**文档编辑服务**执行额外的命令。
- **文档转换服务**：一种服务器服务，用于将文档文件转换为合适的Office Open XML格式（文本文档为*docx*格式，电子表格为*xlsx*格式，演示文稿为*pptx*格式），以便进行编辑或下载。
- **文档构建服务**：一种服务器服务，无需实际运行文档处理编辑器即可轻松构建文档。

请注意，ONLYOFFICE文档包括**文档编辑器**、**文档编辑服务**、**文档命令服务**、**文档转换服务**和**文档构建服务**。**文档管理器**和**文档存储服务**要么包含在ONLYOFFICE工作区中，要么必须由在自己的服务器上使用ONLYOFFICE文档的软件集成商来实现。

## 分片密钥

从8.1版本开始，在向ONLYOFFICE文档API、**文档命令服务**、**文档转换服务**或**文档构建服务**发送请求时，*shardkey*参数会添加到URL的*查询字符串*中。在协同编辑期间，它也会作为[WOPISrc](../../using-wopi/key-concepts.md#wopisrc)查询参数添加到浏览器与服务器的交互中。

*key*字段用作其值。例如，*?shardkey=Khirz6zTPdfd7*。如果请求体中没有密钥，则无需发送（例如，在[getForgottenList](../../additional-api/command-service/getforgottenlist.md)命令中）。

这是在使用编辑器服务器集群时的一个建议，以便在协同编辑期间实现请求的负载均衡：编辑同一文档的所有用户都由同一台服务器提供服务
