name: Sync office-js-api

on:
  workflow_dispatch:
  schedule: 
    - cron: '00 21 * * *'
  
env:
  EVENT: ${{ github.event_name }}
  REF: ${{ github.ref_name }}
  TOKEN_PUBLICK_REPO: ${{ secrets.TOKEN_PUBLICK_REPO }}
  USER_PRIVATE_NAME: ${{ secrets.USER_PRIVATE_NAME }}
  TOKEN_PRIVATE_REPO: ${{ secrets.TOKEN_PRIVATE_REPO }} 
  URL_PRIVATE_REPO: ${{ secrets.URL_PRIVATE_REPO }} 
  
jobs:
  sync:
    name: "Sync"
    runs-on: ubuntu-latest
    steps:
    - name: Master error handler
      if: ( github.event_name == 'workflow_dispatch' && github.ref_name == 'master' )
      run: echo "Can't run from master manualy" && exit 1

    - name: Checkout
      uses: actions/checkout@v4

    - name: Get office-api-js branch
      shell: bash
      run: |
         mkdir -p ${GITHUB_WORKSPACE}/replace-js
         mv ${GITHUB_WORKSPACE}/.github/scripts/replace-office-api-js.sh ${GITHUB_WORKSPACE}/replace-js/replace-office-api-js.sh
         cd ${GITHUB_WORKSPACE}/replace-js
         bash ./replace-office-api-js.sh
